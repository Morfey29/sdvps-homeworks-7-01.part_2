# –î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ –∫ –∑–∞–Ω—è—Ç–∏—é ¬´Ansible.–ß–∞—Å—Ç—å 2¬ª –î–æ–π–∫–æ–≤ –ê.–ú.

### –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –¥–æ–º–∞—à–Ω–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è

1. –î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ [Google Docs](https://docs.google.com/) –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É —Å—Å—ã–ª–∫—É –Ω–∞ –≤–∞—à –¥–æ–∫—É–º–µ–Ω—Ç –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ.  
1. –í –Ω–∞–∑–≤–∞–Ω–∏–∏ —Ñ–∞–π–ª–∞ —É–∫–∞–∂–∏—Ç–µ –Ω–æ–º–µ—Ä –ª–µ–∫—Ü–∏–∏ –∏ —Ñ–∞–º–∏–ª–∏—é —Å—Ç—É–¥–µ–Ω—Ç–∞. –ü—Ä–∏–º–µ—Ä –Ω–∞–∑–≤–∞–Ω–∏—è:  Ansible. –ß–∞—Å—Ç—å 2 ‚Äî –ê–ª–µ–∫—Å–∞–Ω–¥—Ä –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤.
1. –ü–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –¥–æ—Å—Ç—É–ø –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –æ—Ç–∫—Ä—ã—Ç –≤—Å–µ–º, —É –∫–æ–≥–æ –µ—Å—Ç—å —Å—Å—ã–ª–∫–∞. –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –ø—Ä–∏–∫—Ä–µ–ø–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Å—ã–ª–∫–∏, –¥–æ–±–∞–≤—å—Ç–µ –∏—Ö –≤ —Å–≤–æ–π Google Docs.

–í—ã –º–æ–∂–µ—Ç–µ –ø—Ä–∏—Å–ª–∞—Ç—å —Ä–µ—à–µ–Ω–∏–µ –≤ –≤–∏–¥–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ –≤–∞—à —Ä–µ–ø–æ–∑–∏–π—Ç–æ—Ä–∏–π –≤ GitHub, –¥–ª—è —ç—Ç–æ–≥–æ –≤–æ—Å–ø–æ–ª—å–∑—É–π—Ç–µ—Å—å [—à–∞–±–ª–æ–Ω–æ–º –¥–ª—è –¥–æ–º–∞—à–Ω–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è](https://github.com/netology-code/sys-pattern-homework).

---

### –ó–∞–¥–∞–Ω–∏–µ 1

**–í—ã–ø–æ–ª–Ω–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏—è, –ø—Ä–∏–ª–æ–∂–∏—Ç–µ —Ñ–∞–π–ª—ã —Å –ø–ª–µ–π–±—É–∫–∞–º–∏ –∏ –≤—ã–≤–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.**

–ù–∞–ø–∏—à–∏—Ç–µ —Ç—Ä–∏ –ø–ª–µ–π–±—É–∫–∞. –ü—Ä–∏ –Ω–∞–ø–∏—Å–∞–Ω–∏–∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä —Å –ø–æ–¥—Å–≤–µ—Ç–∫–æ–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ YAML.

–ü–ª–µ–π–±—É–∫–∏ –¥–æ–ª–∂–Ω—ã:

1. –°–∫–∞—á–∞—Ç—å –∫–∞–∫–æ–π-–ª–∏–±–æ –∞—Ä—Ö–∏–≤, —Å–æ–∑–¥–∞—Ç—å –ø–∞–ø–∫—É –¥–ª—è —Ä–∞—Å–ø–∞–∫–æ–≤–∫–∏ –∏ —Ä–∞—Å–ø–∞–∫–æ–≤–∞—Ç—å —Å–∫–∞—á–µ–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤. –ù–∞–ø—Ä–∏–º–µ—Ä, –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å [–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–∞–π—Ç](https://kafka.apache.org/downloads) –∏ –∑–µ—Ä–∫–∞–ª–æ Apache Kafka. –ü—Ä–∏ —ç—Ç–æ–º –º–æ–∂–Ω–æ —Å–∫–∞—á–∞—Ç—å –∫–∞–∫ –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥, —Ç–∞–∫ –∏ –±–∏–Ω–∞—Ä–Ω—ã–µ —Ñ–∞–π–ª—ã, –∑–∞–ø–∞–∫–æ–≤–∞–Ω–Ω—ã–µ –≤ –∞—Ä—Ö–∏–≤ ‚Äî –≤ –Ω–∞—à–µ–º –∑–∞–¥–∞–Ω–∏–∏ –Ω–µ –ø—Ä–∏–Ω—Ü–∏–ø–∏–∞–ª—å–Ω–æ.

playbook

```YAML
# install_kafka.yml
---
- name: Download and extract Apache Kafka
  hosts: all
  become: yes
  vars:
    kafka_version: "3.6.1"
    kafka_scala_version: "2.13"
    install_dir: "/opt/kafka"
    download_url: "https://downloads.apache.org/kafka/{{ kafka_version }}/kafka_{{ kafka_scala_version }}-{{ kafka_version }}.tgz"

  tasks:
    - name: Create installation directory
      ansible.builtin.file:
        path: "{{ install_dir }}"
        state: directory
        owner: root
        group: root
        mode: '0755'

    - name: Download Kafka archive
      ansible.builtin.get_url:
        url: "{{ download_url }}"
        dest: "/tmp/kafka.tgz"
        timeout: 60

    - name: Extract Kafka archive
      ansible.builtin.unarchive:
        src: "/tmp/kafka.tgz"
        dest: "{{ install_dir }}"
        remote_src: yes
        extra_opts: ["--strip-components=1"]
        creates: "{{ install_dir }}/bin"

    - name: Set ownership of Kafka directory
      ansible.builtin.file:
        path: "{{ install_dir }}"
        owner: root
        group: root
        recurse: yes

    - name: Clean up temporary archive
      ansible.builtin.file:
        path: "/tmp/kafka.tgz"
        state: absent

    - name: Display installation info
      ansible.builtin.debug:
        msg: "Kafka {{ kafka_version }} successfully installed to {{ install_dir }}"
```

output log

```

PLAY [Download and extract Apache Kafka] ***************************************

TASK [Gathering Facts] *********************************************************
ok: [Ex2]
ok: [10.129.0.33]
ok: [Ex1]
ok: [10.129.0.25]

TASK [Create installation directory] *******************************************
ok: [10.129.0.33]
ok: [Ex2]
ok: [10.129.0.25]
ok: [Ex1]

TASK [Download Kafka archive] **************************************************
changed: [10.129.0.33]
changed: [10.129.0.25]
ok: [Ex1]
ok: [Ex2]

TASK [Extract Kafka archive] ***************************************************
changed: [Ex1]
changed: [10.129.0.25]
changed: [10.129.0.33]
changed: [Ex2]

TASK [Set ownership of Kafka directory] ****************************************
ok: [10.129.0.25]
ok: [10.129.0.33]
ok: [Ex2]
ok: [Ex1]

TASK [Clean up temporary archive] **********************************************
ok: [Ex1]
changed: [10.129.0.25]
changed: [10.129.0.33]
ok: [Ex2]

TASK [Display installation info] ***********************************************
ok: [10.129.0.25] => {
    "msg": "Kafka 4.1.0 successfully installed to /opt/kafka"
}
ok: [10.129.0.33] => {
    "msg": "Kafka 4.1.0 successfully installed to /opt/kafka"
}
ok: [Ex1] => {
    "msg": "Kafka 4.1.0 successfully installed to /opt/kafka"
}
ok: [Ex2] => {
    "msg": "Kafka 4.1.0 successfully installed to /opt/kafka"
}

PLAY RECAP *********************************************************************
10.129.0.25                : ok=7    changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
10.129.0.33                : ok=7    changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
Ex1                        : ok=7    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
Ex2                        : ok=7    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0  
```

2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞–∫–µ—Ç tuned –∏–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –≤–∞—à–µ–π –û–°. –ó–∞–ø—É—Å—Ç–∏—Ç—å –µ–≥–æ, –∫–∞–∫ –¥–µ–º–æ–Ω ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª systemd –ø–æ—è–≤–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ. –î–æ–±–∞–≤–∏—Ç—å tuned –≤ –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫—É.

playbook
```YAML
# setup_tuned.yml
---
- name: Install and configure tuned
  hosts: all
  become: yes

  tasks:
    - name: Update package cache (for apt-based systems)
      ansible.builtin.apt:
        update_cache: yes
      when: ansible_pkg_mgr == 'apt'

    - name: Update package cache (for yum-based systems)
      ansible.builtin.yum:
        update_cache: yes
      when: ansible_pkg_mgr == 'yum'

    - name: Update package cache (for dnf-based systems)
      ansible.builtin.dnf:
        update_cache: yes
      when: ansible_pkg_mgr == 'dnf'

    - name: Install tuned package
      ansible.builtin.package:
        name: tuned
        state: present

    - name: Start tuned service
      ansible.builtin.systemd:
        name: tuned
        state: started
        enabled: yes
        daemon_reload: yes

    - name: Enable and start tuned-profile service (for RHEL/CentOS 8+)
      ansible.builtin.systemd:
        name: tuned-profile
        state: started
        enabled: yes
      when: ansible_os_family == "RedHat" and ansible_distribution_major_version | int >= 8

    - name: Verify tuned service status
      ansible.builtin.systemd:
        name: tuned
        state: started
        enabled: yes

    - name: Display tuned status
      ansible.builtin.command: tuned-adm active
      register: tuned_status
      changed_when: false

    - name: Show tuned status
      ansible.builtin.debug:
        msg: "{{ tuned_status.stdout }}"
```

output log

```
PLAY [Install and configure tuned] *********************************************

TASK [Gathering Facts] *********************************************************
ok: [10.129.0.25]
ok: [10.129.0.33]
ok: [Ex1]
ok: [Ex2]

TASK [Update package cache (for apt-based systems)] ****************************
changed: [Ex2]
changed: [10.129.0.33]
changed: [Ex1]
changed: [10.129.0.25]

TASK [Update package cache (for yum-based systems)] ****************************
skipping: [10.129.0.25]
skipping: [10.129.0.33]
skipping: [Ex1]
skipping: [Ex2]

TASK [Update package cache (for dnf-based systems)] ****************************
skipping: [10.129.0.25]
skipping: [10.129.0.33]
skipping: [Ex1]
skipping: [Ex2]

TASK [Install tuned package] ***************************************************
fatal: [10.129.0.33]: FAILED! => {"cache_update_time": 1758892758, "cache_updated": false, "changed": false, "msg": "'/usr/bin/apt-get -y -o \"Dpkg::Options::=--force-confdef\" -o \"Dpkg::Options::=--force-confold\"       install 'tuned=2.21.0-1ubuntu2'' failed: E: Could not get lock /var/lib/dpkg/lock-frontend. It is held by process 5350 (apt-get)\nE: Unable to acquire the dpkg frontend lock (/var/lib/dpkg/lock-frontend), is another process using it?\n", "rc": 100, "stderr": "E: Could not get lock /var/lib/dpkg/lock-frontend. It is held by process 5350 (apt-get)\nE: Unable to acquire the dpkg frontend lock (/var/lib/dpkg/lock-frontend), is another process using it?\n", "stderr_lines": ["E: Could not get lock /var/lib/dpkg/lock-frontend. It is held by process 5350 (apt-get)", "E: Unable to acquire the dpkg frontend lock (/var/lib/dpkg/lock-frontend), is another process using it?"], "stdout": "", "stdout_lines": []}
fatal: [Ex1]: FAILED! => {"cache_update_time": 1758892780, "cache_updated": false, "changed": false, "msg": "'/usr/bin/apt-get -y -o \"Dpkg::Options::=--force-confdef\" -o \"Dpkg::Options::=--force-confold\"       install 'tuned=2.21.0-1ubuntu2'' failed: E: Could not get lock /var/lib/dpkg/lock-frontend. It is held by process 6985 (apt-get)\nE: Unable to acquire the dpkg frontend lock (/var/lib/dpkg/lock-frontend), is another process using it?\n", "rc": 100, "stderr": "E: Could not get lock /var/lib/dpkg/lock-frontend. It is held by process 6985 (apt-get)\nE: Unable to acquire the dpkg frontend lock (/var/lib/dpkg/lock-frontend), is another process using it?\n", "stderr_lines": ["E: Could not get lock /var/lib/dpkg/lock-frontend. It is held by process 6985 (apt-get)", "E: Unable to acquire the dpkg frontend lock (/var/lib/dpkg/lock-frontend), is another process using it?"], "stdout": "", "stdout_lines": []}
changed: [Ex2]
changed: [10.129.0.25]

TASK [Start tuned service] *****************************************************
ok: [Ex2]
ok: [10.129.0.25]

TASK [Enable and start tuned-profile service (for RHEL/CentOS 8+)] *************
skipping: [Ex2]
skipping: [10.129.0.25]

TASK [Verify tuned service status] *********************************************
ok: [Ex2]
ok: [10.129.0.25]

TASK [Display tuned status] ****************************************************
ok: [Ex2]
ok: [10.129.0.25]

TASK [Show tuned status] *******************************************************
ok: [10.129.0.25] => {
    "msg": "Current active profile: virtual-guest"
}
ok: [Ex2] => {
    "msg": "Current active profile: virtual-guest"
}

PLAY RECAP *********************************************************************
10.129.0.25                : ok=7    changed=2    unreachable=0    failed=0    skipped=3    rescued=0    ignored=0   
10.129.0.33                : ok=2    changed=1    unreachable=0    failed=1    skipped=2    rescued=0    ignored=0   
Ex1                        : ok=2    changed=1    unreachable=0    failed=1    skipped=2    rescued=0    ignored=0   
Ex2                        : ok=7    changed=2    unreachable=0    failed=0    skipped=3    rescued=0    ignored=0  
```

3. –ò–∑–º–µ–Ω–∏—Ç—å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ —Å–∏—Å—Ç–µ–º—ã (motd) –ø—Ä–∏ –≤—Ö–æ–¥–µ –Ω–∞ –ª—é–±–æ–µ –¥—Ä—É–≥–æ–µ. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤ —ç—Ç–æ–º –∑–∞–¥–∞–Ω–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –¥–ª—è –∑–∞–¥–∞–Ω–∏—è –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è. –ü–µ—Ä–µ–º–µ–Ω–Ω—É—é –º–æ–∂–Ω–æ –∑–∞–¥–∞–≤–∞—Ç—å –ª—é–±—ã–º —É–¥–æ–±–Ω—ã–º —Å–ø–æ—Å–æ–±–æ–º.

playbook
```YAML
# configure_motd_with_vars.yml
---
- name: Configure MOTD using external variables
  hosts: all
  become: yes
  vars_files:
    - vars/motd_vars.yml

  tasks:
    - name: Create custom MOTD with variables
      ansible.builtin.template:
        src: motd.j2
        dest: /etc/motd
        owner: root
        group: root
        mode: '0644'

    - name: Reload SSH service to apply new MOTD
      ansible.builtin.systemd:
        name: ssh
        state: reloaded

    - name: Verify MOTD is readable
      ansible.builtin.command: cat /etc/motd
      register: motd_check

    - name: Display current MOTD
      ansible.builtin.debug:
        msg: "–¢–µ–∫—É—â–∏–π MOTD:\n{{ motd_check.stdout }}"
```

output log

```
PLAY [Configure MOTD using external variables] *********************************

TASK [Gathering Facts] *********************************************************
ok: [Ex1]
ok: [Ex2]

TASK [Create custom MOTD with variables] ***************************************
changed: [Ex2]
changed: [Ex1]

PLAY RECAP *********************************************************************
Ex1                        : ok=2    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
Ex2                        : ok=2    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0
```

variables

```YAML
# vars/motd_vars.yml
motd_message: "üöÄ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –Ω–∞ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä!"
company_name: "–ú–æ—è –ö–æ–º–ø–∞–Ω–∏—è"
support_contact: "support@company.com"
```

template

```YAML
##################################################
# {{ motd_message }}
#
# –°–µ—Ä–≤–µ—Ä: {{ ansible_hostname }}
# –û–°: {{ ansible_distribution }} {{ ansible_distribution_version }}
# –ö–æ–º–ø–∞–Ω–∏—è: {{ company_name }}
# –ö–æ–Ω—Ç–∞–∫—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏: {{ support_contact }}
# –î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è: {{ ansible_date_time.iso8601 }}
##################################################
```

screenshot
[–°–∫—Ä–∏–Ω—à–æ—Ç-1](https://github.com/Morfey29/sdvps-homeworks-7-01.part_2/edit/main/README.MD#:~:text=img1.png)

### –ó–∞–¥–∞–Ω–∏–µ 2

**–í—ã–ø–æ–ª–Ω–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏—è, –ø—Ä–∏–ª–æ–∂–∏—Ç–µ —Ñ–∞–π–ª—ã —Å –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –ø–ª–µ–π–±—É–∫–æ–º –∏ –≤—ã–≤–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.**

–ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–π—Ç–µ –ø–ª–µ–π–±—É–∫ –∏–∑ –ø—É–Ω–∫—Ç–∞ 3, –∑–∞–¥–∞–Ω–∏—è 1. –í –∫–∞—á–µ—Å—Ç–≤–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è –æ–Ω –¥–æ–ª–∂–µ–Ω —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å IP-–∞–¥—Ä–µ—Å –∏ hostname —É–ø—Ä–∞–≤–ª—è–µ–º–æ–≥–æ —Ö–æ—Å—Ç–∞, –ø–æ–∂–µ–ª–∞–Ω–∏–µ —Ö–æ—Ä–æ—à–µ–≥–æ –¥–Ω—è —Å–∏—Å—Ç–µ–º–Ω–æ–º—É –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É.

modified template
```YAML
##################################################
|
          ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
          ‚ïë                    –î–û–ë–†–û –ü–û–ñ–ê–õ–û–í–ê–¢–¨                                                                 ‚ïë
          ‚ïë  –Ω–∞ —Å–µ—Ä–≤–µ—Ä {{ ansible_hostname | upper }}{{ ' ' * (25 - ansible_hostname|length) }}               ‚ïë
          ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

          üìä –ò–ù–§–û–†–ú–ê–¶–ò–Ø –û –°–ò–°–¢–ï–ú–ï:
          ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
          üñ•Ô∏è  –•–æ—Å—Ç: {{ ansible_hostname }}
          üåê IP-–∞–¥—Ä–µ—Å: {{ ansible_default_ipv4.address }}
          üêß –û–°: {{ ansible_distribution }} {{ ansible_distribution_version }}
          ‚öôÔ∏è  –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: {{ ansible_architecture }}
          üíæ –û–ó–£: {{ (ansible_memtotal_mb / 1024) | round(1) }} GB
          üîÑ –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã: {{ (ansible_uptime_seconds // 3600) | int }}—á {{ ((ansible_uptime_seconds % 3600) // 60) | int }}–º
          üìÖ –î–∞—Ç–∞: {{ ansible_date_time.date }}
          üïê –í—Ä–µ–º—è: {{ ansible_date_time.time }}

          ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
          –ë—É–¥—å—Ç–µ –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω—ã –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –æ–ø–µ—Ä–∞—Ü–∏–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!
          "–•–æ—Ä–æ—à–µ–≥–æ –¥–Ω—è, —Å–∏—Å—Ç–µ–º–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä! üöÄ"
          ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
##################################################
```

screenshot
[–°–∫—Ä–∏–Ω—à–æ—Ç-2](https://github.com/Morfey29/sdvps-homeworks-7-01.part_2/edit/main/README.MD#:~:text=img2.png)


### –ó–∞–¥–∞–Ω–∏–µ 3

**–í—ã–ø–æ–ª–Ω–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏—è, –ø—Ä–∏–ª–æ–∂–∏—Ç–µ –∞—Ä—Ö–∏–≤ —Å —Ä–æ–ª—å—é –∏ –≤—ã–≤–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.**

–û–∑–Ω–∞–∫–æ–º—å—Ç–µ—Å—å —Å–æ —Å—Ç–∞—Ç—å—ë–π [¬´Ansible - —ç—Ç–æ –≤–∞–º –Ω–µ bash¬ª](https://habr.com/ru/post/494738/), —Å–¥–µ–ª–∞–π—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –≤—ã–≤–æ–¥—ã –∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–æ–¥—É–ª–∏ **shell** –∏–ª–∏ **command** –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∑–∞–¥–∞–Ω–∏—è.

–°–æ–∑–¥–∞–π—Ç–µ –ø–ª–µ–π–±—É–∫, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –≤–∫–ª—é—á–∞—Ç—å –≤ —Å–µ–±—è –æ–¥–Ω—É, —Å–æ–∑–¥–∞–Ω–Ω—É—é –≤–∞–º–∏ —Ä–æ–ª—å. –†–æ–ª—å –¥–æ–ª–∂–Ω–∞:

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤–µ–±-—Å–µ—Ä–≤–µ—Ä Apache –Ω–∞ —É–ø—Ä–∞–≤–ª—è–µ–º—ã–µ —Ö–æ—Å—Ç—ã.
2. –°–∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª index.html c –≤—ã–≤–æ–¥–æ–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ –∫–∞–∂–¥–æ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ –∫–∞–∫ –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü—É –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è Apache. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–∫–ª—é—á–∏—Ç—å CPU, RAM, –≤–µ–ª–∏—á–∏–Ω—É –ø–µ—Ä–≤–æ–≥–æ HDD, IP-–∞–¥—Ä–µ—Å.
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ [Ansible facts](https://docs.ansible.com/ansible/latest/playbook_guide/playbooks_vars_facts.html) –∏ [jinja2-template](https://linuxways.net/centos/how-to-use-the-jinja2-template-in-ansible/). –ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å handler: –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ Apache —Ç–æ–ª—å–∫–æ –≤ —Å–ª—É—á–∞–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Apache.
4. –û—Ç–∫—Ä—ã—Ç—å –ø–æ—Ä—Ç 80, –µ—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ, –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä –∏ –¥–æ–±–∞–≤–∏—Ç—å –µ–≥–æ –≤ –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫—É.
5. –°–¥–µ–ª–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –≤–µ–±-—Å–∞–π—Ç–∞ (–æ—Ç–≤–µ—Ç 200, –º–æ–¥—É–ª—å uri).

–í –∫–∞—á–µ—Å—Ç–≤–µ —Ä–µ—à–µ–Ω–∏—è:
- –ø—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ –ø–ª–µ–π–±—É–∫, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–π —Ä–æ–ª—å;

playbook
```YAML
# playbook.yml
---
- name: Deploy Apache web server with system info
  hosts: serv
  become: yes
  roles:
    - role: apache_server
```

- —Ä–∞–∑–º–µ—Å—Ç–∏—Ç–µ –∞—Ä—Ö–∏–≤ —Å–æ–∑–¥–∞–Ω–Ω–æ–π —Ä–æ–ª–∏ —É —Å–µ–±—è –Ω–∞ Google –¥–∏—Å–∫–µ –∏ –ø—Ä–∏–ª–æ–∂–∏—Ç–µ —Å—Å—ã–ª–∫—É –Ω–∞ —Ä–æ–ª—å –≤ —Å–≤–æ—ë–º —Ä–µ—à–µ–Ω–∏–∏;
```
https://drive.google.com/file/d/1zmdyXENwMGpnGYN6irKCC_nyjlkCEBxW/view?usp=sharing
```

- –ø—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–ª–µ–π–±—É–∫–∞;

output log

```
ansible-playbook -i ./apache_server/hosts.ini ./apache_server/playbook.yml | tee "web_serv_deploy_log$(date +%Y%m%d_%H%M%S).log"

PLAY [Deploy Apache web server with system info] *******************************

TASK [Gathering Facts] *********************************************************
ok: [Ex1]
ok: [Ex2]

TASK [apache_server : Gather system facts] *************************************
ok: [Ex1]
ok: [Ex2]

TASK [apache_server : Install Apache web server] *******************************
ok: [Ex1]
ok: [Ex2]

TASK [apache_server : Ensure Apache is running and enabled] ********************
ok: [Ex1]
ok: [Ex2]

TASK [apache_server : Allow HTTP traffic on port 80 via iptables] **************
ok: [Ex1]
ok: [Ex2]

TASK [apache_server : Save iptables rules] *************************************
changed: [Ex1]
changed: [Ex2]

TASK [apache_server : Create custom index.html from template] ******************
changed: [Ex1]
changed: [Ex2]

TASK [apache_server : Ensure proper permissions on web root] *******************
changed: [Ex1]
changed: [Ex2]

TASK [apache_server : Wait for Apache to start] ********************************
ok: [Ex1]
ok: [Ex2]

TASK [apache_server : Test website availability] *******************************
ok: [Ex1]
ok: [Ex2]

TASK [apache_server : Display website test result] *****************************
ok: [Ex1] => {
    "msg": "–í–µ–±-—Å–∞–π—Ç —É—Å–ø–µ—à–Ω–æ –¥–æ—Å—Ç—É–ø–µ–Ω. –°—Ç–∞—Ç—É—Å: 200"
}
ok: [Ex2] => {
    "msg": "–í–µ–±-—Å–∞–π—Ç —É—Å–ø–µ—à–Ω–æ –¥–æ—Å—Ç—É–ø–µ–Ω. –°—Ç–∞—Ç—É—Å: 200"
}

PLAY RECAP *********************************************************************
Ex1                        : ok=11   changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
Ex2                        : ok=11   changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
```

screenshot
[–°–∫—Ä–∏–Ω—à–æ—Ç-3](https://github.com/Morfey29/sdvps-homeworks-7-01.part_2/edit/main/README.MD#:~:text=img3.png)


- –ø—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç –±—Ä–∞—É–∑–µ—Ä–∞, –æ—Ç–æ–±—Ä–∞–∂–∞—é—â–µ–≥–æ —Å–∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π index.html –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Å–∞–π—Ç–∞.

screenshot
![–°–∫—Ä–∏–Ω—à–æ—Ç-4](https://github.com/Morfey29/sdvps-homeworks-7-01.part_2/edit/main/README.MD#:~:text=img4.png)
